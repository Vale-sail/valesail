{"title":"golang界面程序","date":"2020-06-01T18:11:16.000Z","author":"Vale Sail","slug":"golang界面程序","updated":"2021-03-04T13:48:16.047Z","content":"<p>背景:帮财务小姐姐写一个图形化的工资邮件发送程序。由于我使用的mac，业务方用的是windows 涉及到跨平台的问题，所以想的是采用golang或者java来进行编写，由于自己对于golang熟悉程度，所以果断选用golang</p>\n<h4 id=\"涉及到主要点\">涉及到主要点<a href=\"post/golang界面程序#涉及到主要点\"></a></h4><ol>\n<li>生成PDF<blockquote>\n<ol>\n<li>gopdf 依靠坐标定位，绘制难度大</li>\n<li>wkhtmltopdf html标签转PDF，但是需要单独安装wkhtmltopdf工具</li>\n<li><a href=\"https://github.com/johnfercher/maroto\" target=\"_blank\" rel=\"noopener\">https://github.com/johnfercher/maroto</a> 有标签布局，但是不支持中文</li>\n</ol>\n</blockquote>\n</li>\n<li>excel读取和生成 360EntSecGroup-Skylar/excelize/v2<blockquote>\n<p>国内开源，文档比较完善，支持的功能基本上都有，除了不支持excel设置打开密码，但是支持</p>\n<ol>\n<li>excel的日期存储是数字，是按照1900年1月1日截止当前的天数，和时间戳不一样，时间戳是1970年1月1日开始计算的。处理时需要用获取到的天数减去25569天来计算的天数就是当前时间</li>\n</ol>\n</blockquote>\n</li>\n<li>zip压缩 <ol>\n<li>密码保护，所以golang的自带库无法支持，alexmullins/zip 支持设置密码，但是生成的压缩文件无法被mac的归档工具解压，需要使用其他的解压工具，猜测是秘钥编码问题。 yeka/zip 可以基于alexmullins/zip并且在基础上增加了多种加密，尝试zip.StandardEncryption加密方式，使用mac的归档工具成功解压；</li>\n<li>解压文件乱码 zip库在生成压缩文件时，在mac解压出来的文件文件名无异常，但是在windows平台解压软件是乱码的。在网上查找各种资料，最终得到windows下压缩文件默认编码是GBK的，而go语言的默认编码是UTF8，所以在添加文件时，将文件名编码转为GBK，这样生成的压缩文件在windows上解压就不会出现乱码。由于mac在压缩处理时兼容性比较好，遇到GBK的编码也不会乱码。</li>\n</ol>\n</li>\n<li>邮件发送 需要支持smtp协议并支持附件 gopkg.in/gomail.v2</li>\n<li>可视化<ol>\n<li>fyne-io/fyne 跨平台，开发者在积极维护，但是没有文件选择。</li>\n<li>lxn/walk 基于windows平台，使用windows form 组件，但是文档几乎没有，有demo，可以去搜索windows form的文档来理解。</li>\n<li>还有几个基于html 来布局的库，直接或者间接的使用浏览器内核来渲染。原生JS编写难度太过于复杂，可以采用去vue去编写。会轻松很多，但是使用vue去编写，目前没有现成的框架，需要自己去打包然后编写。更正一下 </li>\n</ol>\n</li>\n</ol>\n<h3 id=\"后续\">后续<a href=\"post/golang界面程序#后续\"></a></h3><pre><code>今天找到了一个 wailsapp/wails 支持VUE来编写，但是我已经用 walk开发完成了\n</code></pre>","prev":{"title":"golang流水线","slug":"golang流水线"},"next":{"title":"0521面试下","slug":"0521面试下"},"link":"https://vale-sail.github.io/post/golang界面程序/"}