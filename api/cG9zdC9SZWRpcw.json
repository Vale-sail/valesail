{"title":"Redis","date":"2020-05-10T17:13:00.000Z","author":"Vale Sail","slug":"Redis","tags":["Redis"],"categories":["学习笔记"],"updated":"2021-03-04T13:48:16.047Z","content":"<h4 id=\"Redis-有哪些数据结构？\">Redis 有哪些数据结构？<a href=\"post/Redis#Redis-有哪些数据结构？\"></a></h4><ol>\n<li>字符串 String</li>\n<li>字典 Hash (压缩列表表 or 散列表+链表(Murmurhash12,解决冲突，渐进式扩容))</li>\n<li>列表 List (先进先出) （压缩列表【64 512】 or 双写循环链表）</li>\n<li>集合 Set (元素唯一) （数组 512证书 散列表）</li>\n<li>有序集合 SortedSet (top N) （压缩列表 64 128）（基于跳表实现）</li>\n<li>Geo 地址位置计算</li>\n<li>不常用的 HyperLogLog Pub/Sub RedisSearch Redis-ML</li>\n</ol>\n<h4 id=\"并发锁\">并发锁<a href=\"post/Redis#并发锁\"></a></h4><ol>\n<li>两条命令setNx + expire</li>\n<li>一条命令 set 特殊参数</li>\n</ol>\n<h4 id=\"key查找\">key查找<a href=\"post/Redis#key查找\"></a></h4><ol>\n<li>keys 但是由于redis 单进程特性，会阻塞其他命令，生产环境禁止使用</li>\n<li>scan 返回重复值</li>\n</ol>\n<h4 id=\"消息队列\">消息队列<a href=\"post/Redis#消息队列\"></a></h4><ol>\n<li>list rpush lpop(不阻塞) blpop(阻塞)</li>\n<li>pub/sub 消费者下线 生产者消息丢失</li>\n<li>beanstalkd 优先队列，延迟队列，超时重发</li>\n<li>kafka 顺序性，append高性能</li>\n<li>sortedset 延迟队列</li>\n</ol>\n<h4 id=\"key过期\">key过期<a href=\"post/Redis#key过期\"></a></h4><ol>\n<li>立即清理</li>\n<li>惰性删除(访问删除)</li>\n<li>定时删除<br>分散过期时间，以免大量key同时过期导致redis卡顿.</li>\n</ol>\n<h3 id=\"同步\">同步<a href=\"post/Redis#同步\"></a></h3><ol>\n<li>bgsave 全量持久化 redis 通过创建子进程来进行 bgsave 操作，cow 指的是 copy on write，子进程创建后，父子进程共享数据段，父进程继续提供读写服务，写脏的页面数据会逐渐和子进程分离开来</li>\n<li>aof 增量持久化  配置刷新时间</li>\n</ol>\n<h3 id=\"业务使用的奇技淫巧\">业务使用的奇技淫巧<a href=\"post/Redis#业务使用的奇技淫巧\"></a></h3><ol>\n<li>pipeline 使用pipeline 合并多条指令，这样就多条指令只有一次网络交互</li>\n<li>一致性hash 减少机器增删 缓存的miss率</li>\n<li>缓存的命中率监控</li>\n</ol>\n<h3 id=\"Redis-的同步机制了解么？\">Redis 的同步机制了解么？<a href=\"post/Redis#Redis-的同步机制了解么？\"></a></h3><p>Redis 可以使用主从同步，从从同步。第一次同步时，主节点做一次 bgsave，并同时将后续修改操作记录到内存 buffer，待完成后将 rdb 文件全量同步到复制节点，复制节点接受完成后将 rdb 镜像加载到内存。加载完成后，再通知主节点将期间修改的操作记录同步到复制节点进行重放就完成了同步过程。</p>\n<h3 id=\"集群的原理是什么？\">集群的原理是什么？<a href=\"post/Redis#集群的原理是什么？\"></a></h3><p>Redis Sentinal 着眼于高可用，在 master 宕机时会自动将 slave 提升为 master，继续提供服务。<br>Redis Cluster 着眼于扩展性，在单个 redis 内存不足时，使用 Cluster 进行分片存储</p>\n","prev":{"title":"0514 小记","slug":"0514面试总结"},"next":{"title":"腾讯CDC面试","slug":"腾讯CDC面试"},"link":"https://vale-sail.github.io/post/Redis/"}